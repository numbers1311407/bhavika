var BP = {
  projects: JSON.parse("<%= js_escape_html(data.projects.to_json) %>"),

  load: function() {
    var match, data,
        hash = window.location.hash,
        id   = hash && (match = hash.match(/\/([^$?]*)/)) && match[1];

    if (!_.isEmpty(BP.projects)) {
      data = id ? _.find(BP.projects, function(p){ return p.id == id }) 
                : BP.projects[0];

      if (data) {
        $("#projects").empty();
        $("#projectTmpl").tmpl(data).hide().appendTo("#projects").fadeIn();
      }
    }
  }
}

$(window).bind('hashchange', BP.load);
$(BP.load);
